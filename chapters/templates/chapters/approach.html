{% extends 'chapters/topic.html' %}
{% load  chapters_extras %}


{% block header %}
  <h2>{{ topic }}</h2>
{% endblock header %}

{% block content %}
<div class="d-flex justify-content-between">
  <div style="width: 50%;">
    <div class="border-bottom">
      <div class="d-flex justify-content-center">
        <a id="task-button" class="btn btn-light px-5">Zadanie</a>
        <a id="console-button" class="btn btn-light px-5">Konsola</a>
      </div>
    </div>
    <div>
      <div id="task">
        <div style="padding: 5px; margin: 5px">{{ topic.text|linebreaks }}</div>
        <div class="terminal mx-auto" >
          {{ topic.code_text|linebreaks }}
        </div>
      </div>

    <div id="console" class="terminal" style="display: none;">
      {% if res %}
          {{ res|linebreaks }}
        </div>
      {% else %}
        <p>Tutaj pojawi się rezultat....</p>
      </div>
      {% endif %}
      
    </div>
  </div>
  <div>
    <form action="{% url 'chapters:approach' topic.id %}" method="post">
        <div style="font-size: 14px; opacity: 0.85;">
        {% csrf_token %}
        {{ form.as_p }}
          <script>
                var editor = CodeMirror.fromTextArea(document.getElementById('editor'), {
                      mode: "python",
                      theme: "elegant",
                      lineNumbers: true,
                      autoCloseBrackets: true,
                      lineWrapping: true,
                  });
                  editor.setSize("400", "300");
            </script>
        </div>
  
        <button name="submit" id="code-run-button" class="btn btn-info float-left">Uruchom</button>
    </form>
      {% if approach.points_awarded %}
          <a href="{% url 'chapters:approach' next_topic_id %}">
              <button id="next_topic_button_id" class="btn btn-warning float-left ml-1" >Następny temat</button>
          </a>
      {% endif %}
    </div>
</div>



<!-- <div style="height: 500px; overflow-y:auto; width: 90%;">
    <table style="max-height: 500px; overflow: auto;">
      <tbody>
        {% for topic in topics %}
        <tr>
            <td class="team">
                <a href="{% url 'chapters:approach' topic.id %}">{{ forloop.counter }}. {{ topic }}</a>
                <span class="badge badge-primary badge-pill ml-2 float-right">
                {% get_topic_points_tag topic user %}
                    /{{ topic.points }}</span>
            </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
</div> -->

<script>
  $(document).ready(function () {
    $("#code-run-button").on("click", () => {
      localStorage.setItem("layout-item", "console")
    })

    $("#task-button").on("click", () => {
      localStorage.setItem("layout-item", "task")
        $("#console").hide()
        $("#task").show()
    })

    $("#console-button").on("click", () => {
      localStorage.setItem("layout-item", "console")
        $("#task").hide()
        $("#console").show()
    })

    $("#next_topic_button_id").on("click", () => {
      localStorage.setItem("layout-item", "task")
    })

    itemToClick = localStorage.getItem("layout-item")
    $("#" + itemToClick + "-button").click()
    }
  )
</script>
{% endblock content %}
